FROM public.ecr.aws/lambda/dotnet:6

CMD [ "MyFunction::MyFunction.Function::HandlerCustomStructParam" ]

RUN mkdir /opt/extensions

ENV CORECLR_ENABLE_PROFILING=1
ENV CORECLR_PROFILER={846F5F1C-F9AE-4B07-969E-05C26BC060D8}

ENV DD_AGENT_HOST=host.docker.internal
ENV DD_DOTNET_TRACER_HOME=/opt/datadog
ENV DD_LAMBDA_HANDLER=MyFunction::MyFunction.Function::FunctionHandler
ENV DD_LOCAL_TEST=1
ENV DD_LOGS_CONFIG_LOGS_DD_URL=127.0.0.1:3333
ENV DD_LOGS_CONFIG_LOGS_NO_SSL=true
ENV DD_LOGS_ENABLED=true
ENV DD_LOG_LEVEL=trace
ENV DD_LOG_PAYLOADS=true
ENV DD_MERGE_XRAY_TRACES=false
ENV DD_SERVERLESS_LOGS_ENABLED=false
ENV DD_SERVICE=integration-test-service
ENV DD_TRACE_DEBUG=true
ENV DD_TRACE_ENABLED=true
ENV DD_TRACE_MANAGED_SERVICES=true

COPY bin/Debug/* ${LAMBDA_TASK_ROOT}
